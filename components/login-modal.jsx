import {
  Box,
  Button,
  Divider,
  Modal,
  ModalOverlay,
  ModalContent,
  ModalHeader,
  ModalFooter,
  ModalBody,
  ModalCloseButton,
  Text,
  Center,
  Image,
  Heading,
  Flex,
} from '@chakra-ui/react'
import { ThemedText, Emphasis } from './themed-text.jsx'
import GoogleIcon from './icons/google.svg'
import { useState } from 'react'
import { signIn, signOut, useSession } from 'next-auth/client'

export default function LoginModal({ isOpen, onClose, action }) {
  const [session, loading] = useSession()

  const headerMessage = () => {
    if (action === 'saveTweet') {
      return (
          <ThemedText>
            To&nbsp;<Emphasis>bookmark</Emphasis>&nbsp;the job,
            <br />
            you have to&nbsp;<Emphasis>login.</Emphasis>
          </ThemedText>
        )
    }
    return (
      <>
        <ThemedText>Welcome to&nbsp;<Emphasis>YellowJobs</Emphasis></ThemedText>
        &nbsp;
        {/*star-struck-emoji*/}
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M24 12C24 18.6273 18.6273 24 12 24C5.37267 24 0 18.6273 0 12C0 5.37267 5.37267 0 12 0C18.6273 0 24 5.37267 24 12Z" fill="#FFCC4D"/>
          <path d="M11.9993 13.9999C9.58402 13.9999 7.98135 13.7186 5.99935 13.3332C5.54668 13.2459 4.66602 13.3332 4.66602 14.6666C4.66602 17.3332 7.72935 20.6666 11.9993 20.6666C16.2687 20.6666 19.3327 17.3332 19.3327 14.6666C19.3327 13.3332 18.452 13.2452 17.9993 13.3332C16.0173 13.7186 14.4147 13.9999 11.9993 13.9999Z" fill="#664500"/>
          <path d="M6 14.6667C6 14.6667 8 15.3334 12 15.3334C16 15.3334 18 14.6667 18 14.6667C18 14.6667 16.6667 17.3334 12 17.3334C7.33333 17.3334 6 14.6667 6 14.6667Z" fill="white"/>
          <path d="M10.4545 2.94178L7.42652 3.47578L5.86652 0.640442C5.69452 0.327775 5.34118 0.160442 4.99185 0.221775C4.64052 0.283775 4.36718 0.562442 4.31252 0.914442L3.81585 4.11244L0.787849 4.64644C0.431183 4.70911 0.155849 4.99644 0.107183 5.35578C0.058516 5.71511 0.247849 6.06444 0.575849 6.22044L3.28918 7.50844L2.79052 10.7164C2.73518 11.0738 2.91652 11.4258 3.23918 11.5891C3.35852 11.6491 3.48652 11.6778 3.61385 11.6778C3.83185 11.6778 4.04718 11.5924 4.20785 11.4298L6.54918 9.05578L9.56118 10.4858C9.88785 10.6404 10.2772 10.5678 10.5252 10.3044C10.7732 10.0411 10.8225 9.64844 10.6485 9.33178L9.08318 6.48644L11.1932 4.34778C11.4479 4.08978 11.5058 3.69644 11.3378 3.37511C11.1685 3.05378 10.8092 2.87978 10.4545 2.94178ZM13.5452 2.94178L16.5732 3.47578L18.1332 0.640442C18.3052 0.327775 18.6585 0.160442 19.0078 0.221775C19.3585 0.283775 19.6318 0.562442 19.6865 0.914442L20.1832 4.11244L23.2112 4.64644C23.5685 4.70911 23.8438 4.99578 23.8918 5.35511C23.9398 5.71444 23.7512 6.06378 23.4232 6.21978L20.7098 7.50778L21.2085 10.7158C21.2638 11.0731 21.0825 11.4251 20.7598 11.5884C20.6405 11.6484 20.5125 11.6771 20.3852 11.6771C20.1672 11.6771 19.9518 11.5918 19.7912 11.4291L17.4498 9.05511L14.4378 10.4851C14.1112 10.6398 13.7218 10.5671 13.4738 10.3038C13.2258 10.0404 13.1765 9.64778 13.3505 9.33111L14.9158 6.48644L12.8058 4.34778C12.5512 4.08978 12.4932 3.69644 12.6612 3.37511C12.8312 3.05378 13.1905 2.87978 13.5452 2.94178Z" fill="#E95F28"/>
        </svg>
      </>
    )
  }

  return isOpen && !session ? (
    <Modal isOpen={isOpen} onClose={onClose} isCentered={{base: 'false', md: 'true'}} scrollBehavior="inside">
      <ModalOverlay />
      <ModalContent mt={{base: 'auto', md: '0'}} mb="0">
        <ModalHeader>
          <Center>{headerMessage()}</Center>
        </ModalHeader>
        <ModalCloseButton />
        <Divider />
        <ModalBody p="0">
          <Box p="8">
            <Text pb="0.5rem">Log in using</Text>
            <Button
              w="100%"
              bg="#FAFAFA"
              variant="outline"
              leftIcon={<GoogleIcon />}
              onClick={() => signIn('google')}
            >
              Google
            </Button>
          </Box>
          {action ? null : (
            <Box bg="#FAFAFA" p="8" rounded="md">
              <Heading as="h5" size="sm">
                Why log in is needed you ask?
              </Heading>
              <Flex flexDirection="row">
                <Text>You can bookmark tweets after you log in.</Text>
                {/*sunglasses-emoji*/}
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20 10C20 15.5228 15.5228 20 10 20C4.47722 20 0 15.5228 0 10C0 4.47722 4.47722 0 10 0C15.5228 0 20 4.47722 20 10Z" fill="#FFCC4D"/>
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M0.688451 6.12111C0.821784 6.25389 1.48734 6.65278 1.62012 7.05167C1.75345 7.45 2.02012 9.70945 2.81901 10.3744C3.64289 11.0589 6.75067 10.8044 7.34567 10.5078C8.67734 9.84389 8.84067 7.99056 9.07623 7.05167C9.20901 6.52 10.0079 6.52 10.0079 6.52C10.0079 6.52 10.8068 6.52 10.9401 7.05111C11.1757 7.99056 11.3401 9.84389 12.6707 10.5072C13.2662 10.8044 16.374 11.0594 17.199 10.375C17.9968 9.71 18.2629 7.45056 18.3962 7.05167C18.5285 6.65334 19.1951 6.25445 19.3279 6.12167C19.4618 5.98889 19.4618 5.45722 19.3279 5.32389C19.0618 5.05834 15.9201 4.82167 12.5373 5.19111C11.8623 5.265 11.6057 5.45667 10.0073 5.45667C8.41012 5.45667 8.15234 5.26445 7.47789 5.19111C4.09734 4.82111 0.955117 5.05778 0.688451 5.32334C0.555673 5.45611 0.555673 5.98834 0.688451 6.12111Z" fill="#292F33"/>
                  <path d="M15.1866 13.1272C15.0877 13.0378 14.9399 13.0322 14.8338 13.1111C14.8121 13.1272 12.6549 14.7222 10.0005 14.7222C7.3527 14.7222 5.18825 13.1272 5.16714 13.1111C5.06103 13.0322 4.91325 13.0389 4.81436 13.1272C4.71603 13.2161 4.69381 13.3628 4.76214 13.4761C4.83381 13.5956 6.54936 16.3889 10.0005 16.3889C13.4516 16.3889 15.1677 13.5956 15.2388 13.4761C15.3071 13.3622 15.2855 13.2161 15.1866 13.1272Z" fill="#664500"/>
                </svg>
              </Flex>
            </Box>
          )}
        </ModalBody>
      </ModalContent>
    </Modal>
  ) : null
}
